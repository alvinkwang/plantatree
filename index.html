<!doctype html>
<html xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<title>PlantATree by alvinkwang</title>

<link rel="stylesheet" href="stylesheets/styles.css">
<link rel="stylesheet" href="stylesheets/pygment_trac.css">
<meta name="viewport"
	content="width=device-width, initial-scale=1, user-scalable=no">
<!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>

	<!-- FB Login Button -->
	<div id="fb-root"></div>
	<script type="text/javascript">
		var button;
		var userInfo;

		window.fbAsyncInit = function() {
			FB.init({
				appId : '242823765864186', //change the appId to your appId
				status : true,
				cookie : true,
				xfbml : true,
				oauth : true
			});

			showLoader(true);

			function updateButton(response) {
				button = document.getElementById('fb-auth');
				userInfo = document.getElementById('user-info');

				if (response.authResponse) {
					//user is already logged in and connected
					FB.api('/me', function(info) {
						login(response, info);
					});

					var button = document.getElementById('fb-auth');
					button.style.display = 'none';
/* 					button.onclick = function() {
						FB.logout(function(response) {
							logout(response);
						});
					}; */
				} else {
					//user is not connected to your app or logged out
					button.innerHTML = 'Login';
					button.onclick = function() {
						showLoader(true);
						FB
								.login(
										function(response) {
											if (response.authResponse) {
												FB.api('/me', function(info) {
													login(response, info);
												});
											} else {
												//user cancelled login or did not grant authorization
												showLoader(false);
											}
										},
										{
											scope : 'email,user_birthday,status_update,publish_stream,user_about_me'
										});
					}
				}
			}

			// run once with current status and whenever the status changes
			FB.getLoginStatus(updateButton);
			FB.Event.subscribe('auth.statusChange', updateButton);
		};
		(function() {
			var e = document.createElement('script');
			e.async = true;
			e.src = document.location.protocol
					+ '//connect.facebook.net/en_US/all.js';
			document.getElementById('fb-root').appendChild(e);
		}());

		function login(response, info) {
			if (response.authResponse) {
				var accessToken = response.authResponse.accessToken;

				userInfo.innerHTML = '<img src="https://graph.facebook.com/' + info.id + '/picture">'
						+ info.name
						+ info.email
						+ "<br /> Your Access Token: "
						+ accessToken;
				button.innerHTML = 'Logout';
				showLoader(false);
				document.getElementById('other').style.display = "block";
			}
		}

		function logout(response) {
			userInfo.innerHTML = "";
			document.getElementById('debug').innerHTML = "";
			document.getElementById('other').style.display = "none";
			showLoader(false);
		}

		function fqlQuery() {
			showLoader(true);

			FB
					.api(
							'/me',
							function(response) {
								showLoader(false);

								//http://developers.facebook.com/docs/reference/fql/user/
								var query = FB.Data
										.query(
												'select name, profile_url, sex, pic_small from user where uid={0}',
												response.id);
								query
										.wait(function(rows) {
											document.getElementById('debug').innerHTML = 'FQL Information: '
													+ "<br />"
													+ 'Your name: '
													+ rows[0].name
													+ "<br />"
													+ 'Your Sex: '
													+ (rows[0].sex != undefined ? rows[0].sex
															: "")
													+ "<br />"
													+ 'Your Profile: '
													+ "<a href='" + rows[0].profile_url + "'>"
													+ rows[0].profile_url
													+ "</a>"
													+ "<br />"
													+ '<img src="'       +  rows[0].pic_small + '" alt="" />'
													+ "<br />";
										});
							});
		}

		function setStatus() {
			showLoader(true);

			status1 = document.getElementById('status').value;
			FB
					.api(
							{
								method : 'status.set',
								status : status1
							},
							function(response) {
								if (response == 0) {
									alert('Your facebook status not updated. Give Status Update Permission.');
								} else {
									alert('Your facebook status updated');
								}
								showLoader(false);
							});
		}

		function showLoader(status) {
			if (status)
				document.getElementById('loader').style.display = 'block';
			else
				document.getElementById('loader').style.display = 'none';
		}
	</script>

	<!-- Like Button -->
	<script>
		(function(d, s, id) {
			var js, fjs = d.getElementsByTagName(s)[0];
			if (d.getElementById(id))
				return;
			js = d.createElement(s);
			js.id = id;
			js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=223110031167007";
			fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));
	</script>

	<button id="fb-auth">Login</button>
	<div id="loader" style="display: none"></div>
	<br />
	<div id="user-info"></div>
	<br />
	<div id="debug"></div>


	<div class="wrapper">
		<header>


			<div class="fb-like" data-send="false" data-width="450"
				data-show-faces="false" data-font="tahoma"></div>

			<h1>PlantATree on Cloud9!</h1>
			<p></p>

			<p class="view">
				<a href="https://github.com/alvinkwang/plantatree">View the
					Project on GitHub <small>alvinkwang/plantatree</small>
				</a>
			</p>

		</header>
		<footer>
			<p>
				This project is maintained by <a
					href="https://github.com/alvinkwang">alvinkwang</a>
			</p>
			<p>
				<small>Hosted on GitHub Pages &mdash; Theme by <a
					href="https://github.com/orderedlist">orderedlist</a></small>
			</p>
		</footer>
	</div>
	<script src="javascripts/scale.fix.js"></script>

</body>
</html>
